<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Player Timer Control</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
        }
        .setup {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }
        .game {
            display: flex;
            height: 100vh;
            position: relative;
        }
        .player {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            cursor: pointer;
            border: 1px solid #000;
            user-select: none;
            position: relative;
        }
        .player1 {
            background-color: #f0f0f0;
        }
        .player2 {
            background-color: #d0f0d0;
        }
        .name {
            position: absolute;
            top: 20px;
            font-size: 1.5rem;
        }
        .time-bar {
            width: 80%;
            height: 20px;
            background-color: #ccc;
            position: absolute;
            bottom: 40px;
        }
        .time-bar-inner {
            height: 100%;
            background-color: #76c7c0;
        }
        .winner {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            font-size: 2rem;
        }
        .winner button {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 1rem;
            cursor: pointer;
        }
        .control-buttons {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 10;
            display: flex;
            gap: 5px;
        }
        .control-buttons button {
            background: none;
            border: 1px solid black;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>

<div class="setup" id="setup">
    <h1>Introdueix el nom i els temps dels jugadors</h1>
    <form id="setupForm">
        <label>
            Jugador 1 - NOM:
            <input type="text" id="player1Name" value="Player_1" required>
        </label>
        <br><br>
        <label>
            Jugador 1 - TEMPS (segons):
            <input type="number" id="player1Time" value="60" required>
        </label>
        <br><br>
        <label>
            Jugador 2 - NOM:
            <input type="text" id="player2Name" value="Player_2" required>
        </label>
        <br><br>
        <label>
            Jugador 2 - TEMPS (segons):
            <input type="number" id="player2Time" value="60" required>
        </label>
        <br><br>
        <button type="submit">que comenci el joc!</button>
    </form>
</div>

<div class="game" id="game" style="display: none;">
    <div class="control-buttons">
        <button onclick="toggleFullscreen()">â›¶</button>
        <button onclick="toggleColors()">ðŸŽ¨</button>
    </div>
    <div class="player player1" id="player1">
        <div class="name" id="player1NameDisplay"></div>
        <div id="player1TimeDisplay"></div>
        <div class="time-bar">
            <div class="time-bar-inner" id="player1TimeBar"></div>
        </div>
    </div>
    <div class="player player2" id="player2">
        <div class="name" id="player2NameDisplay"></div>
        <div id="player2TimeDisplay"></div>
        <div class="time-bar">
            <div class="time-bar-inner" id="player2TimeBar"></div>
        </div>
    </div>
</div>

<div class="winner" id="winner">
    <div id="winnerMessage"></div>
    <button onclick="restartGame()">Restart</button>
</div>

<script>
    const setupForm = document.getElementById('setupForm');
    const setupDiv = document.getElementById('setup');
    const gameDiv = document.getElementById('game');
    const winnerDiv = document.getElementById('winner');
    const winnerMessage = document.getElementById('winnerMessage');
    const player1Div = document.getElementById('player1');
    const player2Div = document.getElementById('player2');
    const player1NameDisplay = document.getElementById('player1NameDisplay');
    const player2NameDisplay = document.getElementById('player2NameDisplay');
    const player1TimeDisplay = document.getElementById('player1TimeDisplay');
    const player2TimeDisplay = document.getElementById('player2TimeDisplay');
    const player1TimeBar = document.getElementById('player1TimeBar');
    const player2TimeBar = document.getElementById('player2TimeBar');

    let player1Time, player2Time, player1InitialTime, player2InitialTime;
    let activePlayer = null;
    let timer;

    setupForm.addEventListener('submit', (e) => {
        e.preventDefault();

        const player1Name = document.getElementById('player1Name').value;
        const player2Name = document.getElementById('player2Name').value;

        player1Time = player1InitialTime = parseInt(document.getElementById('player1Time').value, 10);
        player2Time = player2InitialTime = parseInt(document.getElementById('player2Time').value, 10);

        player1NameDisplay.textContent = player1Name;
        player2NameDisplay.textContent = player2Name;

        player1TimeDisplay.textContent = `${player1Time}s`;
        player2TimeDisplay.textContent = `${player2Time}s`;

        player1TimeBar.style.width = '100%';
        player2TimeBar.style.width = '100%';

        setupDiv.style.display = 'none';
        gameDiv.style.display = 'flex';
    });

    function switchPlayer(player) {
        clearInterval(timer);

        if (player === 'player1') {
            activePlayer = 'player2';
        } else {
            activePlayer = 'player1';
        }

        timer = setInterval(() => {
            if (activePlayer === 'player1') {
                player1Time--;
                player1TimeDisplay.textContent = `${player1Time}s`;
                player1TimeBar.style.width = `${(player1Time / player1InitialTime) * 100}%`;

                if (player1Time <= 0) {
                    endGame(player2NameDisplay.textContent);
                }
            } else if (activePlayer === 'player2') {
                player2Time--;
                player2TimeDisplay.textContent = `${player2Time}s`;
                player2TimeBar.style.width = `${(player2Time / player2InitialTime) * 100}%`;

                if (player2Time <= 0) {
                    endGame(player1NameDisplay.textContent);
                }
            }
        }, 1000);
    }

    function endGame(winner) {
        clearInterval(timer);
        gameDiv.style.display = 'none';
        winnerDiv.style.display = 'flex';
        winnerMessage.textContent = `${winner} has won the game!`;
    }

    function restartGame() {
        winnerDiv.style.display = 'none';
        setupDiv.style.display = 'flex';
    }

    function toggleFullscreen() {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen();
        } else {
            document.exitFullscreen();
        }
    }

    function toggleColors() {
        function getRandomLightColor() {
            const r = Math.floor(Math.random() * 128 + 128);
            const g = Math.floor(Math.random() * 128 + 128);
            const b = Math.floor(Math.random() * 128 + 128);
            return `rgb(${r}, ${g}, ${b})`;
        }

        const color1 = getRandomLightColor();
        const color2 = getRandomLightColor();

        player1Div.style.backgroundColor = color1;
        player2Div.style.backgroundColor = color2;
    }

    player1Div.addEventListener('click', () => switchPlayer('player1'));
    player2Div.addEventListener('click', () => switchPlayer('player2'));
</script>

</body>
</html>
